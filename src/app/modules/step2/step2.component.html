<app-top-bar [numberstep]=2></app-top-bar>
<div class="container col-sm-9">
    <app-steps-bar [numberstep]=2 [nameEntity]="paymentData.nameEntity"></app-steps-bar>
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="container m-3">            
            <div class="row">
                <div class="col">
                    <div class="row">
                    <p class="ft14">De acuerdo a los datos ingresados, se realizará el siguiente pago desde tu cuenta:</p>
                    </div>                         
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-md-6">
                    <div class="row my-2">
                    <p class="ft18"> Detalles de la transaccion</p>
                    </div>
                    <div class="row my-2">                
                        <div class="col-6 ft16">Concepto Pago</div>
                        <div class="col-6 ft16"><b>{{paymentData.paymetDescription}}</b></div>
                    </div>                
                    <div class="row my-2">                
                        <div class="col-6 ft16">Costo</div>
                        <div class="col-6 ft16"><b>$ {{paymentData.transactionCost|number:'1.2-2'}}{{paymentData.money_code}}</b></div>
                    </div>
                    <div class="row my-2">                
                        <div class="col-6 ft16">Entidad</div>
                        <div class="col-6 ft16"><b>{{paymentData.nameEntity}}</b></div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-6">
                    <div class="row my-2">
                        <p class="ft18"> Detalles del pago</p>
                    </div>
                    <div class="row my-2">                
                        <div class="col-6 ft16">Cuenta</div>
                        <div class="col-6 ft16"><b>{{paymentData.product_mask_id}}</b></div>
                    </div>                
                    <div class="row my-2">                
                        <div class="col-6 ft16">Disponible en cuenta</div>
                        <div class="col-6 ft16"><b>$ {{paymentData.available_balance|number:'1.2-2'}}{{paymentData.money_code}}</b></div>
                    </div>                
                    <div class="row my-2">                
                        <div class="col-6 ft16">Valor a pagar</div>
                        <div class="col-6 ft16"><b>$ {{paymentData.operationValue|number:'1.2-2'}}{{paymentData.money_code}}</b></div>
                    </div>                
                </div>
            </div>
            <div class="row my-3">
                <div class="mx-1">
                    <div class="form-check custom-control custom-checkbox custom-checkbox-green"  *ngIf="paymentRecurring">
                        <input class="form-check-input custom-control-input custom-control-input-green" type="checkbox" (change)="changePaymentRecurring($event)">
                        <label class="col-6 ft16">
                            Pago Recurrente
                        </label>
                    </div>
                </div>
            </div>

            <div class="row" *ngIf="otp_type=='OTP'">
                <div class="col ft16">
                    <b>Ingreso de clave de seguridad</b>
                </div>
            </div>
            <div class="row"  *ngIf="otp_type=='OTP'">
                <div class="col-6 col-xs-12 ft15">
                    Recibirás SMS o llamada con la clave de seguridad a tu celular {{cellPhone}} Ingrésala dentro de los próximos 5 minutos.
                </div>
                <div class="col-3 col-xs-12" >
                    <input type="text" formControlName="otp" maxlength="6" (keypress)="numberOnly($event)"
                        [ngClass]="submitted && f['otp'].errors ? 'form-control ft13g is-invalid' : 'form-control ft13g'"/>
                    <div *ngIf="submitted && f['otp'].errors" class="ft12 invalid-feedback d-block">
                        <div *ngIf="f['otp'].errors['required']">OTP requerido</div>                        
                    </div>
                </div>
                <div class="col-3 col-xs-12">
                    <img src="assets/logos/softoken.jpg" width="200px"/>
                </div>
            </div>
            <div class="row border-10"  *ngIf="otp_type=='TIMESOFTTOKEN'">
                <div class="col-5 col-xs-12">
                    <h5 class="ftg text-left">Ingreso de Clave Dinámica</h5>
                    <div>
                        <p class="ft14dy">Ingresa el código de seguridad de 6 dígitos que aparece en tu app <b class="ftg">Banco Falabella</b></p>
                    </div>
                </div>
                
                <div class="col-2 col-xs-12" >
                    <input type="text" formControlName="sofToken" maxlength="6" (keypress)="numberOnly($event)"
                        [ngClass]="submitted && f['sofToken'].errors ? 'form-control ft13g is-invalid' : 'form-control ft13g'"/>
                    <div *ngIf="submitted && f['sofToken'].errors" class="ft12 invalid-feedback d-block">
                        <div *ngIf="f['sofToken'].errors['required']">Clave Dinamica requerida</div>                        
                    </div>
                </div>
                <div class="col-3 col-xs-12">
                    <p class="ft14dy">Encuentra tu <b class="ftg">Clave Dinámica</b> en la pantalla principal de tu app  <b class="ftg">Banco Falabella</b></p>
                </div>
                <div class="col-2 col-xs-12">
                    <img src="assets/logos/celular-lup-vu.png" height="100px"/>
                </div>
            </div>
            <div class="row m-4">
                <div class="col-xs-0 col-sm-3 col-md-3">
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">                
                    <button type="button" class="btn col-12 btnCancel">Cancelar</button>                                
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">                
                    <button type="submit" class="btn col-12 btnContinue">Continuar</button>                
                </div>
                <div class="col-xs-0 col-sm-3 col-md-3">
                </div>
            </div>
        </div>
    </form>
    <!-- Modal -->
</div>
<app-bottom-bar [numberstep]=2></app-bottom-bar>


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5 ft16" id="exampleModalLabel">Pago Recurrente</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p class="ft14">El pago recurrente te permite que para el proximo pago de la entidad <b>{{paymentData.nameEntity}}</b> no deba ingresar al banco. 
            <br/>Automaticamente llegara a este paso de verificacion para finalizar el pago</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btnCancel" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>